{
  "customer_analytics": {
    "customer_lifetime_value": "\n            SELECT \n                customer_id,\n                first_name,\n                last_name,\n                SUM(total_amount) as lifetime_value,\n                COUNT(order_id) as total_orders,\n                AVG(total_amount) as avg_order_value,\n                MIN(order_date) as first_order_date,\n                MAX(order_date) as last_order_date,\n                DATEDIFF(MAX(order_date), MIN(order_date)) as customer_lifespan_days\n            FROM orders o\n            JOIN customers c ON o.customer_id = c.customer_id\n            GROUP BY customer_id, first_name, last_name\n        ",
    "customer_segmentation": "\n            WITH customer_metrics AS (\n                SELECT \n                    customer_id,\n                    SUM(total_amount) as lifetime_value,\n                    COUNT(order_id) as frequency,\n                    DATEDIFF(CURRENT_DATE, MAX(order_date)) as recency\n                FROM orders\n                GROUP BY customer_id\n            )\n            SELECT \n                customer_id,\n                lifetime_value,\n                frequency,\n                recency,\n                CASE \n                    WHEN recency <= 30 AND frequency >= 5 AND lifetime_value >= 1000 THEN 'Champions'\n                    WHEN recency <= 60 AND frequency >= 3 AND lifetime_value >= 500 THEN 'Loyal Customers'\n                    WHEN recency <= 90 AND frequency >= 2 THEN 'Potential Loyalists'\n                    WHEN recency <= 180 THEN 'At Risk'\n                    ELSE 'Lost'\n                END as segment\n            FROM customer_metrics\n        "
  },
  "sales_analytics": {
    "daily_sales_summary": "\n            SELECT \n                DATE(order_date) as sale_date,\n                COUNT(order_id) as total_orders,\n                SUM(total_amount) as total_revenue,\n                AVG(total_amount) as avg_order_value,\n                COUNT(DISTINCT customer_id) as unique_customers\n            FROM orders\n            WHERE order_status = 'Completed'\n            GROUP BY DATE(order_date)\n            ORDER BY sale_date\n        ",
    "product_performance": "\n            SELECT \n                product_category,\n                COUNT(order_id) as total_orders,\n                SUM(quantity) as total_units_sold,\n                SUM(total_amount) as total_revenue,\n                AVG(unit_price) as avg_unit_price\n            FROM orders\n            WHERE order_status = 'Completed'\n            GROUP BY product_category\n            ORDER BY total_revenue DESC\n        "
  }
}